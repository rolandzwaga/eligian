{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://eligius.dev/schemas/event-action-configuration.json",
  "title": "Eligius Event Action Configuration",
  "description": "JSON schema for event-triggered actions in Eligius configuration (compiled from Eligian DSL)",
  "type": "object",
  "required": ["id", "name", "eventName", "startOperations"],
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for this event action (UUID v4 generated by compiler)",
      "examples": ["a1b2c3d4-e5f6-7890-abcd-ef1234567890"]
    },
    "name": {
      "type": "string",
      "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
      "description": "Event action name (alphanumeric + underscores, must not start with digit)",
      "minLength": 1,
      "examples": ["HandleLanguageChange", "OnTimelineComplete", "ProcessUserClick"]
    },
    "eventName": {
      "type": "string",
      "minLength": 1,
      "description": "Name of the event that triggers this action (from Eligius eventbus)",
      "examples": ["language-change", "timeline-complete", "user-click", "timeline-play"]
    },
    "eventTopic": {
      "type": "string",
      "minLength": 1,
      "description": "Optional topic for namespacing events of the same name",
      "examples": ["navigation", "form-submission", "user-selection"]
    },
    "startOperations": {
      "type": "array",
      "minItems": 1,
      "description": "Operations to execute when the event is broadcast (must have at least one operation)",
      "items": {
        "$ref": "#/definitions/OperationConfiguration"
      }
    }
  },
  "definitions": {
    "OperationConfiguration": {
      "type": "object",
      "required": ["id", "systemName"],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique identifier for this operation (UUID v4 generated by compiler)"
        },
        "systemName": {
          "type": "string",
          "description": "Name of the Eligius operation to execute",
          "examples": ["selectElement", "setTextContent", "addClass", "removeClass", "animate"]
        },
        "operationData": {
          "type": "object",
          "description": "Operation-specific parameters (structure depends on operation type)",
          "additionalProperties": true,
          "examples": [
            {
              "selector": ".language-display"
            },
            {
              "textContent": "$operationData.eventArgs[0]"
            }
          ]
        }
      }
    }
  },
  "examples": [
    {
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "name": "HandleLanguageChange",
      "eventName": "language-change",
      "eventTopic": "user-selection",
      "startOperations": [
        {
          "id": "op-uuid-1",
          "systemName": "selectElement",
          "operationData": {
            "selector": ".language-display"
          }
        },
        {
          "id": "op-uuid-2",
          "systemName": "setTextContent",
          "operationData": {
            "textContent": "$operationData.eventArgs[0]"
          }
        }
      ]
    },
    {
      "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
      "name": "OnTimelineComplete",
      "eventName": "timeline-complete",
      "startOperations": [
        {
          "id": "op-uuid-3",
          "systemName": "selectElement",
          "operationData": {
            "selector": "#completion-message"
          }
        },
        {
          "id": "op-uuid-4",
          "systemName": "removeClass",
          "operationData": {
            "className": "hidden"
          }
        }
      ]
    }
  ]
}
